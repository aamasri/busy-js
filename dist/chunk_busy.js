"use strict";(self.webpackChunk_aamasri_busy=self.webpackChunk_aamasri_busy||[]).push([[297],{389:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{queue:()=>queue,reset:()=>reset,start:()=>start,status:()=>status,stop:()=>stop});const debug=!1;let busyAnimation=!1,modalOverlay=!1,fadeoutAnimationTimer=!1,fadeoutModalTimer=!1,queue=[];async function start(id,timeout=7,modal=!1){window.clearTimeout(fadeoutAnimationTimer),id=id?id.replace(/'/g,""):"",timeout="number"==typeof timeout?1e3*timeout:7e3;const duplicateItem=queue.findIndex((item=>item.id===id));duplicateItem>-1&&(queue.splice(duplicateItem,1),debug&&console.debug(`busy item "${id}" already in queue!`)),queue.push({id:id,expiry:Date.now()+timeout,modal:modal}),_updateBusy(),window.setTimeout((()=>{stop(id)}),timeout)}function stop(id){if(queue.length){let arrayIndex;(id=id?id.toString().replace(/'/g,""):"")&&(arrayIndex=queue.findIndex((busyItem=>busyItem.id===id)),arrayIndex>-1&&(debug&&console.debug(`busy item "${queue[arrayIndex].id}" stopped!`),queue.splice(arrayIndex,1))),queue.forEach((item=>{item.expiry<=Date.now()&&(arrayIndex=queue.findIndex((busyItem=>busyItem.id===item.id)),arrayIndex>-1&&(debug&&console.debug(`removing expired busy item "${queue[arrayIndex].id}"`),queue.splice(arrayIndex,1)))}))}_updateBusy()}function reset(){queue=[],_updateBusy()}function status(){console.log("busy queue:",queue)}function _updateBusy(){debug&&console.debug(`_updateBusy() queue length: ${queue.length}`),0===queue.length?(window.clearTimeout(fadeoutAnimationTimer),busyAnimation.style.opacity="0",fadeoutAnimationTimer=window.setTimeout((()=>{busyAnimation.style.display="none"}),500),_fadeOutModal()):(!function(id){if(window.clearTimeout(fadeoutAnimationTimer),!busyAnimation){const body=window.location!==window.parent.location?parent.document.body:document.body;modalOverlay=document.createElement("div"),modalOverlay.id="animated-loader-modal-overlay",document.body.appendChild(modalOverlay),busyAnimation=document.createElement("div"),busyAnimation.id="animated-loader",busyAnimation.innerHTML="<div><div><div><div><div><div><div><div><div><div></div></div></div></div></div></div></div></div></div>",body.appendChild(busyAnimation)}const topZ=function(){let zTop=0;const elements=document.getElementsByTagName("*");for(let i=0;i<elements.length;i++){let zIndex=window.getComputedStyle(elements[i]).getPropertyValue("z-index");zIndex=isNaN(zIndex)?0:parseInt(zIndex),zIndex&&zIndex>zTop&&(zTop=zIndex)}return zTop}().toString();busyAnimation.style.zIndex=topZ,modalOverlay.style.zIndex=topZ,busyAnimation.title=id,busyAnimation.style.display="block",busyAnimation.style.opacity="1"}(queue[0].id),queue.some((item=>item.modal))?(window.clearTimeout(fadeoutModalTimer),modalOverlay.style.display="block",modalOverlay.style.opacity="1"):_fadeOutModal())}function _fadeOutModal(){window.clearTimeout(fadeoutModalTimer),modalOverlay.style.opacity="0",fadeoutModalTimer=window.setTimeout((()=>{modalOverlay.style.display="none"}),500)}}}]);