"use strict";(self.webpackChunk_aamasri_busy=self.webpackChunk_aamasri_busy||[]).push([[297],{389:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{queue:()=>queue,reset:()=>reset,start:()=>start,status:()=>status,stop:()=>stop});const debug=!1;let busyAnimation=!1,modalOverlay=!1;const queue=[];async function start(id,timeout=7,modal=!1){id=id?id.replace(/'/g,""):"",timeout="number"==typeof timeout?1e3*timeout:7e3;const expiry=Date.now()+timeout;if(queue.push({id:id,expiry:expiry,modal:modal}),!busyAnimation){const body=window.location!==window.parent.location?parent.document.body:document.body;modalOverlay=document.createElement("div"),modalOverlay.id="animated-loader-modal-overlay",document.body.appendChild(modalOverlay),busyAnimation=document.createElement("div"),busyAnimation.id="animated-loader",busyAnimation.title=id,busyAnimation.innerHTML="<div><div><div><div><div><div><div><div><div><div></div></div></div></div></div></div></div></div></div>",body.appendChild(busyAnimation)}busyAnimation.style.zIndex=function(){let zTop=0;const elements=document.getElementsByTagName("*");for(let i=0;i<elements.length;i++){let zIndex=window.getComputedStyle(elements[i]).getPropertyValue("z-index");zIndex=isNaN(zIndex)?0:parseInt(zIndex),zIndex&&zIndex>zTop&&(zTop=zIndex)}return zTop}().toString(),busyAnimation.style.display="block",busyAnimation.style.opacity="1",modal&&(modalOverlay.style.opacity="0.4"),window.setTimeout((()=>{stop(id)}),timeout)}function stop(id){if(!queue.length)return;let arrayIndex;(id=id?id.toString().replace(/'/g,""):"")&&(arrayIndex=queue.findIndex((busyItem=>busyItem.id===id)),arrayIndex>-1&&(debug&&console.debug(`busy item "${queue[arrayIndex].id}" completed before timeout!`),queue.splice(arrayIndex,1))),arrayIndex=queue.findIndex((busyItem=>busyItem.expiry<=Date.now())),arrayIndex>-1&&(console.warn(`busy indication timed out waiting for "${queue[arrayIndex].id}" to finish!`),queue.splice(arrayIndex,1)),arrayIndex=queue.findIndex((busyItem=>busyItem.modal)),-1===arrayIndex&&_hideModalOverlay(),0===queue.length&&(_hideModalOverlay(),busyAnimation.style.opacity="0")}function _hideModalOverlay(){modalOverlay.style.opacity="0"}function reset(){queue.length=0,busyAnimation.style.opacity="0"}function status(){console.log("busy queue:",queue)}}}]);