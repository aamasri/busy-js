{"version":3,"file":"chunk_busy.js","mappings":"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","sources":["webpack://@aamasri/busy/./src/busy.js","webpack://@aamasri/busy/./src/busy.styl?2349"],"sourcesContent":["/**\n * @fileOverview busy animation\n */\n\nconst debug = false;\n\nimport './busy.styl';\n\nlet busyAnimation = null;\nlet modalOverlay = null;\nlet fadeoutAnimationTimer;\nlet fadeoutModalTimer;\n\n\n\n// start loading animation\nexport function start(id, timeout=7, modal=false) {\n    window.top.clearTimeout(fadeoutAnimationTimer);\n    id = id ? id.replace(/'/g, '') : '';\t// strip any single quotes from id\n    timeout = (typeof timeout === 'number') ? timeout * 1000 : 7000;\n\n    _initQueue();\n\n    const duplicateItem = window.top.busyQueue.findIndex(item => item.id === id);\n    if (duplicateItem > -1) {\n        window.top.busyQueue.splice(duplicateItem, 1);\n        if (debug) console.debug(`busy item \"${id}\" already in queue!`);\n    }\n\n    // the queue is the master list controlling the busy animation\n    window.top.busyQueue.push({\n        id: id,\n        expiry: Date.now() + timeout,\n        modal: modal\n    });\n\n    _updateBusy();\n    window.top.setTimeout(() => { stop(id); }, timeout);   // dequeue item after timeout\n}\n\n\n\n\n// stop loading animation\nexport function stop(id) {\n    _initQueue();\n\n    if (window.top.busyQueue.length) {\n        id = id ? id.toString().replace(/'/g, '') : '';\t// strip any single quotes from id\n        let arrayIndex;\n\n        // pop specified busy id off queue\n        if (id) {\n            arrayIndex = window.top.busyQueue.findIndex(busyItem => busyItem.id === id);\n            if (arrayIndex > -1) {\n                if (debug) console.debug(`busy item \"${window.top.busyQueue[arrayIndex].id}\" stopped!`);\n                window.top.busyQueue.splice(arrayIndex, 1);\n            }\n        }\n\n        // remove any expired item from the queue\n        window.top.busyQueue.forEach(item => {\n            if (item.expiry <= Date.now()) {\n                arrayIndex = window.top.busyQueue.findIndex(busyItem => busyItem.id === item.id);\n                if (arrayIndex > -1) {\n                    if (debug) console.debug(`removing expired busy item \"${window.top.busyQueue[arrayIndex].id}\"`);\n                    window.top.busyQueue.splice(arrayIndex, 1);\n                }\n            }\n        })\n    }\n\n    _updateBusy();\n}\n\n\n\n\n// clear the busy queue and stop the busy animation\nexport function reset() {\n    window.top.busyQueue = [];\n    _updateBusy();\n}\n\n\n\n// debug the busy animation queue\nexport function status() {\n    _initQueue();\n    console.log('busy queue:', window.top.busyQueue);\n}\n\n\n\n\n////////////////////// SUPPORTING FUNCTIONS //////////////////////\n\nfunction _initQueue() {\n    if (typeof window.top.busyQueue !== 'object')\n        window.top.busyQueue = [];\n}\n\n\n\n// monitor the queue and update the busy animation\nfunction _updateBusy() {\n    if (debug) console.debug(`_updateBusy() queue length: ${window.top.busyQueue.length}`);\n    if (window.top.busyQueue.length === 0) {\n        _fadeOutAnimation();\n        _fadeOutModal();\n    } else {\n        _showAnimation(window.top.busyQueue[0].id);\n        if (window.top.busyQueue.some(item => item.modal))\n            _showModal()\n        else\n            _fadeOutModal();\n    }\n}\n\n\nfunction _showAnimation(id) {\n    window.top.clearTimeout(fadeoutAnimationTimer);\n\n    // the busy animation is always on the root document\n    busyAnimation = busyAnimation || window.top.document.body.querySelector('#animated-loader');\n\n    // create busy animation elements if it doesn't exist (they can be hidden but never removed)\n    if (busyAnimation === null) {\n        modalOverlay = document.createElement('div');\n        modalOverlay.id = 'animated-loader-modal-overlay';\n        window.top.document.body.appendChild(modalOverlay);\n\n        busyAnimation = document.createElement('div');\n        busyAnimation.id = 'animated-loader';\n        busyAnimation.innerHTML = '<div><div><div><div><div><div><div><div><div><div></div></div></div></div></div></div></div></div></div>';\n        window.top.document.body.appendChild(busyAnimation);\n    }\n\n    const topZ = _onTopZIndex().toString();\n    busyAnimation.style.zIndex = topZ;\n    modalOverlay.style.zIndex = topZ;\n    busyAnimation.title = id;\n    busyAnimation.style.display = 'block';\n    busyAnimation.style.opacity = '1';\n}\n\nfunction _showModal() {\n    window.top.clearTimeout(fadeoutModalTimer);\n    modalOverlay.style.display = 'block';\n    modalOverlay.style.opacity = '1';\n}\n\nfunction _fadeOutAnimation() {\n    window.top.clearTimeout(fadeoutAnimationTimer);\n\n    // fade out\n    busyAnimation.style.opacity = '0';\n\n    // then hide\n    fadeoutAnimationTimer = window.top.setTimeout(() => {\n        busyAnimation.style.display = 'none';\n    }, 500);   // hide\n}\n\nfunction _fadeOutModal() {\n    window.top.clearTimeout(fadeoutModalTimer);\n\n    // fadeout\n    modalOverlay.style.opacity = '0';\n\n    // then hide\n    fadeoutModalTimer = window.top.setTimeout(() => {\n        modalOverlay.style.display = 'none';\n    }, 500);   // hide\n}\n\n\n\n\n/** Get the highest z-index in the document.\n *\n * @returns {number}\n */\nfunction _onTopZIndex() {\n    let zTop = 0;\n    const elements = document.getElementsByTagName('*');\n\n    for (let i = 0; i < elements.length; i++) {\n        let zIndex = window.top.getComputedStyle(elements[i]).getPropertyValue('z-index');\n        zIndex = isNaN(zIndex) ? 0 : parseInt(zIndex);\n        if (zIndex && zIndex > zTop)\n            zTop = zIndex;\n    }\n\n    return zTop;\n}\n\n","// extracted by mini-css-extract-plugin\nexport {};"],"names":["debug","busyAnimation","modalOverlay","fadeoutAnimationTimer","fadeoutModalTimer","start","id","timeout","modal","window","top","clearTimeout","replace","_initQueue","duplicateItem","busyQueue","findIndex","item","splice","console","push","expiry","Date","now","_updateBusy","setTimeout","stop","length","toString","arrayIndex","busyItem","forEach","reset","status","log","_fadeOutAnimation","_fadeOutModal","_showAnimation","some","_showModal","document","body","querySelector","createElement","appendChild","innerHTML","topZ","_onTopZIndex","style","zIndex","title","display","opacity","zTop","elements","getElementsByTagName","i","getComputedStyle","getPropertyValue","isNaN","parseInt"],"sourceRoot":""}