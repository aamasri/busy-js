{"version":3,"file":"chunk_busy.js","mappings":"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","sources":["webpack://@aamasri/busy/./src/busy.js","webpack://@aamasri/busy/./src/busy.styl?2349"],"sourcesContent":["/**\n * @fileOverview busy animation\n * @author Ananda Masri\n * @version 1.0.0\n */\n\nconst debug = false;\n\nimport './busy.styl';\n\nlet busyAnimation = false;\nlet modalOverlay = false;\nexport const queue = [];\n\n\n\n// start loading animation\nexport async function start(id, timeout=7, modal=false) {\n    id = id ? id.replace(/'/g, '') : '';\t// strip any single quotes from id\n    timeout = (typeof timeout === 'number') ? timeout * 1000 : 7000;\n    const expiry = Date.now() + timeout;\n\n    queue.push({ id: id, expiry: expiry, modal: modal });     // allows matching id to be stopped\n\n    if (!busyAnimation) {\n        const isInIframe = window.location !== window.parent.location;\t\t// detects whether we're in an iframe\n        const body = isInIframe ? parent.document.body : document.body;\n\n        modalOverlay = document.createElement('div');\n        modalOverlay.id = 'animated-loader-modal-overlay';\n        document.body.appendChild(modalOverlay);\n\n        busyAnimation = document.createElement('div');\n        busyAnimation.id = 'animated-loader';\n        busyAnimation.title = id;\n        busyAnimation.innerHTML = '<div><div><div><div><div><div><div><div><div><div></div></div></div></div></div></div></div></div></div>';\n        body.appendChild(busyAnimation);\n    }\n\n    busyAnimation.style.zIndex = onTopZIndex().toString();\n    busyAnimation.style.display = 'block';   // fade in\n    busyAnimation.style.opacity = '1';   // fade in\n\n    if (modal)\n        modalOverlay.style.opacity = '0.4';   // fade in\n\n    window.setTimeout(() => { stop(id); }, timeout);   // dequeue\n}\n\n\n\n\n// stop loading animation\nexport function stop(id) {\n    if (!queue.length)\n        return;\n\n    id = id ? id.toString().replace(/'/g, '') : '';\t// strip any single quotes from id\n    let arrayIndex;\n\n    // pop specified busy id off queue\n    if (id) {\n        arrayIndex = queue.findIndex(busyItem => busyItem.id === id);\n        if (arrayIndex > -1) {\n            if (debug) console.debug(`busy item \"${queue[arrayIndex].id}\" completed before timeout!`);\n            queue.splice(arrayIndex, 1);\n        }\n    }\n\n    // find any expired busy item\n    arrayIndex = queue.findIndex(busyItem => busyItem.expiry <= Date.now());\n    if (arrayIndex > -1) {\n        console.warn(`busy indication timed out waiting for \"${queue[arrayIndex].id}\" to finish!`);\n        queue.splice(arrayIndex, 1);\n    }\n\n    // kill modal overlay if no modal items left in queue\n    arrayIndex = queue.findIndex(busyItem => busyItem.modal);\n    if (arrayIndex === -1)\n        _hideModalOverlay();\n\n    if (queue.length === 0) {\n        _hideModalOverlay();\n        busyAnimation.style.opacity = '0';\t\t// fade out\n    }\n}\n\n\n\nfunction _hideModalOverlay() {\n    modalOverlay.style.opacity = '0';   // fade out\n}\n\n\n\n// clear the busy queue and stop the busy animation\nexport function reset() {\n    queue.length = 0;\n    busyAnimation.style.opacity = '0';\t\t// fade out\n}\n\n\n\n// debug the busy animation queue\nexport function status() {\n    console.log('busy queue:', queue);\n}\n\n\n\n/** Get the highest z-index in the document.\n *\n * @returns {number}\n */\nfunction onTopZIndex() {\n    let zTop = 0;\n    const elements = document.getElementsByTagName('*');\n\n    for (let i = 0; i < elements.length; i++) {\n        let zIndex = window.getComputedStyle(elements[i]).getPropertyValue('z-index');\n        zIndex = isNaN(zIndex) ? 0 : parseInt(zIndex);\n        if (zIndex && zIndex > zTop)\n            zTop = zIndex;\n    }\n\n    return zTop;\n}\n\n","// extracted by mini-css-extract-plugin\nexport {};"],"names":["debug","busyAnimation","modalOverlay","queue","start","id","timeout","modal","replace","expiry","Date","now","push","isInIframe","window","location","parent","body","document","createElement","appendChild","title","innerHTML","style","zIndex","onTopZIndex","toString","display","opacity","setTimeout","stop","length","arrayIndex","findIndex","busyItem","console","splice","warn","_hideModalOverlay","reset","status","log","zTop","elements","getElementsByTagName","i","getComputedStyle","getPropertyValue","isNaN","parseInt"],"sourceRoot":""}