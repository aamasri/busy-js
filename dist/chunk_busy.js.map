{"version":3,"file":"chunk_busy.js","mappings":"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","sources":["webpack://@aamasri/busy/./src/busy.js","webpack://@aamasri/busy/./src/busy.styl"],"sourcesContent":["/**\n * @fileOverview busy animation\n */\n\nconst debug = false;\n\nimport './busy.styl';\n\nlet busyAnimation = null;\nlet modalUnderlay = null;\nlet fadeoutAnimationTimer;\nlet fadeoutModalTimer;\n\n\n\n// start loading animation\nexport function start(id, timeout=7, modal=false) {\n    window.clearTimeout(fadeoutAnimationTimer);\n    id = id ? id.replace(/'/g, '') : '';\t// strip any single quotes from id\n    timeout = (typeof timeout === 'number') ? timeout * 1000 : 7000;\n\n    _initQueue();\n\n    const duplicateItem = window.busyQueue.findIndex(item => item.id === id);\n    if (duplicateItem > -1) {\n        window.busyQueue.splice(duplicateItem, 1);\n        if (debug) console.debug(`busy item \"${id}\" already in queue!`);\n    }\n\n    // the queue is the master list controlling the busy animation\n    window.busyQueue.push({\n        id: id,\n        expiry: Date.now() + timeout,\n        modal: modal\n    });\n\n    _updateBusy();\n    window.setTimeout(() => { stop(id); }, timeout);   // dequeue item after timeout\n}\n\n\n\n\n// stop loading animation\nexport function stop(id) {\n    _initQueue();\n\n    if (window.busyQueue.length) {\n        id = id ? id.toString().replace(/'/g, '') : '';\t// strip any single quotes from id\n        let arrayIndex;\n\n        // pop specified busy id off queue\n        if (id) {\n            arrayIndex = window.busyQueue.findIndex(busyItem => busyItem.id === id);\n            if (arrayIndex > -1) {\n                if (debug) console.debug(`busy item \"${window.busyQueue[arrayIndex].id}\" stopped!`);\n                window.busyQueue.splice(arrayIndex, 1);\n            }\n        }\n\n        // remove any expired item from the queue\n        window.busyQueue.forEach(item => {\n            if (item.expiry <= Date.now()) {\n                arrayIndex = window.busyQueue.findIndex(busyItem => busyItem.id === item.id);\n                if (arrayIndex > -1) {\n                    if (debug) console.debug(`removing expired busy item \"${window.busyQueue[arrayIndex].id}\"`);\n                    window.busyQueue.splice(arrayIndex, 1);\n                }\n            }\n        })\n    }\n\n    _updateBusy();\n}\n\n\n\n\n// clear the busy queue and stop the busy animation\nexport function reset() {\n    window.busyQueue = [];\n    _updateBusy();\n}\n\n\n\n// debug the busy animation queue\nexport function status() {\n    _initQueue();\n    console.log('busy queue:', window.busyQueue);\n}\n\n\n\n\n////////////////////// SUPPORTING FUNCTIONS //////////////////////\n\nfunction _elementExists(el) {\n    return (typeof el !== 'undefined' && (el instanceof Element));\n}\n\n\nfunction _initQueue() {\n    if (typeof window.busyQueue !== 'object')\n        window.busyQueue = [];\n}\n\n\n// monitor the queue and update the busy animation\nfunction _updateBusy() {\n    if (debug) console.debug(`_updateBusy() queue length: ${window.busyQueue.length}`);\n    if (window.busyQueue.length === 0) {\n        _fadeOutAnimation();\n        _fadeOutModal();\n    } else {\n        _showAnimation(window.busyQueue[0].id);\n        if (window.busyQueue.some(item => item.modal))\n            _showModal()\n        else\n            _fadeOutModal();\n    }\n}\n\n\nfunction _showAnimation(id) {\n    window.clearTimeout(fadeoutAnimationTimer);\n\n    // create the busy animation and modal underlay if it doesn't exist\n    if (!_elementExists(modalUnderlay)) {\n        modalUnderlay = window.document.body.querySelector('#animated-loader-modal-underlay');\n        if (modalUnderlay === null) {\n            modalUnderlay = window.document.createElement('div');\n            modalUnderlay.id = 'animated-loader-modal-underlay';\n            window.document.body.appendChild(modalUnderlay);\n        }\n    }\n\n    if (!_elementExists(busyAnimation)) {\n        busyAnimation = window.document.body.querySelector('#animated-loader');\n        if (busyAnimation === null) {\n            busyAnimation = window.document.createElement('div');\n            busyAnimation.id = 'animated-loader';\n            busyAnimation.innerHTML = '<div><div><div><div><div><div><div><div><div><div></div></div></div></div></div></div></div></div></div>';\n            window.document.body.appendChild(busyAnimation);\n        }\n    }\n\n    const topZ = _onTopZIndex().toString();\n    busyAnimation.style.zIndex = topZ;\n    modalUnderlay.style.zIndex = topZ;\n    busyAnimation.title = id;\n    busyAnimation.style.display = 'block';\n    busyAnimation.style.opacity = '1';\n}\n\nfunction _showModal() {\n    window.clearTimeout(fadeoutModalTimer);\n    if (_elementExists(modalUnderlay)) {\n        modalUnderlay.style.display = 'block';\n        modalUnderlay.style.opacity = '1';\n    }\n}\n\nfunction _fadeOutAnimation() {\n    window.clearTimeout(fadeoutAnimationTimer);\n\n    // fade out\n    if (_elementExists(busyAnimation))\n        busyAnimation.style.opacity = '0';\n\n    // then hide\n    fadeoutAnimationTimer = window.setTimeout(() => {\n        if (_elementExists(busyAnimation))\n            busyAnimation.style.display = 'none';\n    }, 500);   // hide\n}\n\nfunction _fadeOutModal() {\n    window.clearTimeout(fadeoutModalTimer);\n\n    // fadeout\n    if (_elementExists(modalUnderlay))\n        modalUnderlay.style.opacity = '0';\n\n    // then hide\n    fadeoutModalTimer = window.setTimeout(() => {\n        if (_elementExists(modalUnderlay))\n            modalUnderlay.style.display = 'none';\n    }, 500);   // hide\n}\n\n\n\n\n/** Get the highest z-index in the document.\n *\n * @returns {number}\n */\nfunction _onTopZIndex() {\n    let zTop = 0;\n    const elements = window.document.getElementsByTagName('*');\n\n    for (let i = 0; i < elements.length; i++) {\n        let zIndex = window.getComputedStyle(elements[i]).getPropertyValue('z-index');\n        zIndex = isNaN(zIndex) ? 0 : parseInt(zIndex);\n        if (zIndex && zIndex > zTop)\n            zTop = zIndex;\n    }\n\n    return zTop;\n}","// extracted by mini-css-extract-plugin\nexport {};"],"names":["debug","busyAnimation","modalUnderlay","fadeoutAnimationTimer","fadeoutModalTimer","start","id","timeout","modal","window","clearTimeout","replace","_initQueue","duplicateItem","busyQueue","findIndex","item","splice","console","push","expiry","Date","now","_updateBusy","setTimeout","stop","length","toString","arrayIndex","busyItem","forEach","reset","status","log","_elementExists","el","Element","_fadeOutAnimation","_fadeOutModal","_showAnimation","some","_showModal","document","body","querySelector","createElement","appendChild","innerHTML","topZ","_onTopZIndex","style","zIndex","title","display","opacity","zTop","elements","getElementsByTagName","i","getComputedStyle","getPropertyValue","isNaN","parseInt"],"sourceRoot":""}